# XSS分类与漏洞挖掘

![](/attackUsers/xss/image/xss-17.png)

---
## 01. 前言
当第一期出来的时候，反馈很好，但还是有很多人提出疑问，我这里就解答下。

```
问1：如果我输入PHP语句会不会执行。
答1：不会，因为XSS是面对前台的(用户可见部分)，而PHP则是后台处理(用户不可见部分)，如果可以执行PHP语句的话，那不叫XSS，叫"任意代码执行"。

问2：XSS和CSRF有什么区别么？
答2：有的，XSS是获取信息，不需要提前知道其他用户页面的代码和数据包。CSRF是代替用户完成指定的动作，需要知道其他用户页面的代码和数据包。

问3：为什么我在chrome浏览器下测试<script>alert("xss")</script>并没有成功。
答3：chrome内核与ie内核不一样，chrome的过滤机制比ie强。现在测试xss一般都拿能过chrome的为主，所以当你输入xss的时候，可能被chrome的过滤机制给过滤了。
```

## 02. 反射型XSS
反射XSS是XSS分类中最多的，他们原理是下面这样：

>Hacker——发现存在反射XSS的URL——根据输出点的环境构造XSS代码——进行编码、缩短(可有可无，是为了增加迷惑性)——发送给受害人——受害打开后，执行XSS代码——完成hacker想要的功能(获取cookies、url、浏览器信息、IP等等)

原理搞清楚，那就说说怎么挖掘吧.
现在市面上的软件(JSky、Safe3WVS、Netsparker等)都可以挖掘出反射XSS，但是想要那些更隐蔽的XSS还是需要手工的，我先使用软件挖掘一些反射XSS，然后介绍手工挖掘。

![](/attackUsers/xss/image/xss-18.png)

找到后，我们来打开

```
http://gdjy.hfut.edu.cn/viewcomp.jsp?id=hzgz123
```

打开后，我们试着在参数也就是id=hzgz123后面加上woaini(或则其他字符，这串字符必须保持唯一性，也就是说在整个网站里，他必须唯一一个不和其他字符相同的字符串)输入woaini后，打开，查看源代码(ctrl+u)，按下ctrl+f来搜索woaini字符串，看出现在哪个位置。

![](/attackUsers/xss/image/xss-19.png)

我们发现woaini字符在a标签的href属性里，那我们就可以根据这个环境来构造了，我们可以用`"></a><script>alert("xss")</script>`来先闭合掉a标签。然后再用script来运行js代码。也可以这样`onclick="alert(1)";>123</a>//`点击123触发onclick来运行js，然后把后面的内容来注释掉。构造好代码后，把url变成短连接，发送给管理员，诱惑管理员打开，就可以获取管理员的cookies了。

OK，软件挖XSS大致就这些，手工其实和这差不多，手工的话，记住一句话“`见框就插`、`改数据包不可见部分`、`改URL参数`、`js分析`”就可以了。改数据包、js分析比较深，现在我就不再阐述了，见框就插，大家应该都明白，** 找到一个input输入框，先输入唯一字符串，然后看源代码里有没有出现** ，再输入1<>""/&()`来看看过滤了哪些字符，根据过滤的字符，来构造xss。